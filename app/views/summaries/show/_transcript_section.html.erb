<%# Transcript Section %>
<%= turbo_frame_tag "transcript" do %>
  <div class="bg-white/35 dark:bg-gray-800/35 backdrop-blur-sm rounded-lg shadow p-4 lg:p-6 border border-gray-200 dark:border-gray-700"
       data-controller="transcript-download copy"
       data-transcript-download-full-value="<%= summary[:transcript_full].to_s.gsub("\n", " ").gsub('"', '&quot;') %>"
       data-transcript-download-video-id-value="<%= summary[:video_id] %>">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4">
      <h3 class="text-xl lg:text-lg font-semibold text-gray-900 dark:text-white">
        Transcript
      </h3>
      <% unless summary[:loading] %>
        <div class="flex gap-2 w-full sm:w-auto sm:justify-end">
          <button type="button"
                  class="inline-flex items-center justify-center gap-2 px-3 py-2 sm:px-3 sm:py-1.5 rounded-md text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100 transition-colors text-sm"
                  data-action="click->copy#copy"
                  data-copy-target="button">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"/>
            </svg>
          </button>
          <button type="button"
                  class="inline-flex w-full sm:w-auto items-center justify-center gap-2 px-3 py-2 sm:px-3 sm:py-1.5 rounded-md bg-purple-600 text-white hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600 transition-colors text-sm"
                  data-action="transcript-download#downloadSegmented">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 sm:h-4 sm:w-4" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 16a1 1 0 0 1-.7-.29l-4-4a1 1 0 1 1 1.4-1.42L11 12.59V4a1 1 0 1 1 2 0v8.59l2.3-2.3a1 1 0 0 1 1.4 1.42l-4 4a1 1 0 0 1-.7.29z" />
              <path d="M5 18a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1z" />
            </svg>
            <span class="sm:hidden">Download</span>
            <span class="hidden sm:inline">Download Transcript</span>
          </button>
        </div>
      <% end %>
    </div>

    <% if summary[:loading] %>
      <div class="animate-pulse space-y-3">
        <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"></div>
        <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"></div>
        <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3"></div>
      </div>
    <% else %>
      <div class="space-y-2 max-h-[500px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600 scrollbar-track-gray-100 dark:scrollbar-track-gray-800 pr-2"
           data-youtube-target="transcript"
           data-copy-target="source">
        <%= render partial: "summaries/show/transcript_segment", collection: summary[:transcript_segmented] %>
      </div>
    <% end %>
  </div>
<% end %>